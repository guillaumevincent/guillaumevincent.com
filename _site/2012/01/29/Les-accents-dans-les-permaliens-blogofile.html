<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" lang="fr"><!--<![endif]-->

<head>
    <meta charset="utf-8">
    <title>Supprimer les accents des titres blogofile</title>
    <meta name="viewport" content="width=device-width" />
    <title>Site personnel de Guillaume Vincent</title>

    <link rel="stylesheet" href="/css/normalize.css" />
    <link rel="stylesheet" href="/css/foundation.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/css/pygments.css" />
    <script src="/js/custom.modernizr.js"></script>

</head>
<body>

  <nav style="" class="top-bar">
    <ul class="title-area">
      <!-- Title Area -->
      <li class="name">
        <h1><a href="/">Guillaume <span class="orange">Vincent</span></a></h1>
    </li>
    <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
    <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
</ul>


<section class="top-bar-section">
  <!-- Right Nav Section -->
  <ul class="right">
    <li class="divider"></li>
    <li class="has-form">
      <a href="/" class="button alert">Blog</a>
  </li>
  <li class="divider"></li>
  <li class="has-form">
      <a href="https://github.com/guillaumevincent/" class="button success">Code</a>
  </li>
  <li class="divider"></li>
  <li class="has-form">
      <a href="/contact.html" class="button">A propos</a>
  </li>
  <li class="divider"></li>
  <li class="has-form">
      <a href="http://okiwi.org/" class="button okiwi">Okiwi</a>
  </li>
  <li class="divider"></li>
    <li class="has-form">
      <a href="http://guillaumevincent.com/feed.xml" class="button rss">RSS</a>
  </li>
</ul>
</section>
</nav>

<script src="/js/jquery-1.9.0.min.js"></script>


<div class="row">
	<div class="large-9 columns post-title"><h1>Supprimer les accents des titres blogofile</h1> </div>
	<div class="large-3 columns post-date"> 29 Jan 2012 </div>
</div>


<div class="row">
	<div class="large-12 columns post-content">
		<p>Blogofile, le générateur de blog statique que j&#8217;utilise, a la fâcheuse tendance de mettre des accents dans les permaliens de nos billets. C&#8217;est assez ennuyeux, surtout si comme moi votre hébergeur n&#8217;accepte pas les caractères unicodes dans ses urls. J&#8217;ai modifié un hack de <a href='http://twitter.com/zzzeek'>zzzeek</a> qui corrigeait ce défaut, mais qui supprimait les accents. J&#8217;ai amélioré cette modification pour remplacer les accents par les lettres correspondantes.</p>
<a href='http://techspot.zzzeek.org/2010/12/06/my-blogofile-hacks/'>ancien hack</a><div class='highlight'><pre><code class='python'><span class='n'>diff</span> <span class='o'>--</span><span class='n'>git</span> <span class='n'>a</span><span class='o'>/</span><span class='n'>_controllers</span><span class='o'>/</span><span class='n'>blog</span><span class='o'>/</span><span class='n'>post</span><span class='o'>.</span><span class='n'>py</span> <span class='n'>b</span><span class='o'>/</span><span class='n'>_controllers</span><span class='o'>/</span><span class='n'>blog</span><span class='o'>/</span><span class='n'>post</span><span class='o'>.</span><span class='n'>py</span>
<span class='n'>index</span> <span class='n'>c95b580</span><span class='o'>..</span><span class='mi'>0</span><span class='n'>a8922e</span> <span class='mi'>100644</span>
<span class='o'>---</span> <span class='n'>a</span><span class='o'>/</span><span class='n'>_controllers</span><span class='o'>/</span><span class='n'>blog</span><span class='o'>/</span><span class='n'>post</span><span class='o'>.</span><span class='n'>py</span>
<span class='o'>+++</span> <span class='n'>b</span><span class='o'>/</span><span class='n'>_controllers</span><span class='o'>/</span><span class='n'>blog</span><span class='o'>/</span><span class='n'>post</span><span class='o'>.</span><span class='n'>py</span>
<span class='err'>@@</span> <span class='o'>-</span><span class='mi'>24</span><span class='p'>,</span><span class='mi'>6</span> <span class='o'>+</span><span class='mi'>24</span><span class='p'>,</span><span class='mi'>8</span> <span class='err'>@@</span> <span class='kn'>import</span> <span class='nn'>BeautifulSoup</span>
 
 <span class='kn'>import</span> <span class='nn'>blogofile_bf</span> <span class='kn'>as</span> <span class='nn'>bf</span>
 
<span class='o'>+</span><span class='kn'>import</span> <span class='nn'>unicodedata</span>
<span class='o'>+</span>
 <span class='n'>logger</span> <span class='o'>=</span> <span class='n'>logging</span><span class='o'>.</span><span class='n'>getLogger</span><span class='p'>(</span><span class='s'>&quot;blogofile.post&quot;</span><span class='p'>)</span>
 
 <span class='n'>config</span> <span class='o'>=</span> <span class='n'>bf</span><span class='o'>.</span><span class='n'>config</span><span class='o'>.</span><span class='n'>controllers</span><span class='o'>.</span><span class='n'>blog</span><span class='o'>.</span><span class='n'>post</span>
<span class='err'>@@</span> <span class='o'>-</span><span class='mi'>158</span><span class='p'>,</span><span class='mi'>7</span> <span class='o'>+</span><span class='mi'>160</span><span class='p'>,</span><span class='mi'>8</span> <span class='err'>@@</span> <span class='k'>class</span> <span class='nc'>Post</span><span class='p'>(</span><span class='nb'>object</span><span class='p'>):</span>
	          <span class='n'>text</span> <span class='o'>=</span> <span class='s'>&#39;&#39;</span><span class='o'>.</span><span class='n'>join</span><span class='p'>(</span><span class='n'>s</span><span class='o'>.</span><span class='n'>findAll</span><span class='p'>(</span><span class='n'>text</span><span class='o'>=</span><span class='bp'>True</span><span class='p'>))</span>\
	                              <span class='o'>.</span><span class='n'>replace</span><span class='p'>(</span><span class='s'>&quot;</span><span class='se'>\n</span><span class='s'>&quot;</span><span class='p'>,</span> <span class='s'>&quot;&quot;</span><span class='p'>)</span><span class='o'>.</span><span class='n'>split</span><span class='p'>(</span><span class='s'>&quot; &quot;</span><span class='p'>)</span>
	          <span class='k'>return</span> <span class='s'>&quot; &quot;</span><span class='o'>.</span><span class='n'>join</span><span class='p'>(</span><span class='n'>text</span><span class='p'>[:</span><span class='n'>num_words</span><span class='p'>])</span> <span class='o'>+</span> <span class='s'>&#39;...&#39;</span>
<span class='o'>-</span>        
<span class='o'>+</span>  	
<span class='o'>+</span>
	 <span class='k'>def</span> <span class='nf'>__post_process</span><span class='p'>(</span><span class='bp'>self</span><span class='p'>):</span>
	     <span class='c'># fill in empty default value</span>
	     <span class='k'>if</span> <span class='ow'>not</span> <span class='bp'>self</span><span class='o'>.</span><span class='n'>title</span><span class='p'>:</span>
<span class='err'>@@</span> <span class='o'>-</span><span class='mi'>166</span><span class='p'>,</span><span class='mi'>7</span> <span class='o'>+</span><span class='mi'>169</span><span class='p'>,</span><span class='mi'>31</span> <span class='err'>@@</span> <span class='k'>class</span> <span class='nc'>Post</span><span class='p'>(</span><span class='nb'>object</span><span class='p'>):</span>
	                 <span class='n'>datetime</span><span class='o'>.</span><span class='n'>datetime</span><span class='o'>.</span><span class='n'>now</span><span class='p'>()</span><span class='o'>.</span><span class='n'>strftime</span><span class='p'>(</span><span class='s'>&quot;%Y-%m-</span><span class='si'>%d</span><span class='s'> %H:%M:%S&quot;</span><span class='p'>))</span>
	     
	     <span class='k'>if</span> <span class='ow'>not</span> <span class='bp'>self</span><span class='o'>.</span><span class='n'>slug</span><span class='p'>:</span>
<span class='o'>-</span>            <span class='bp'>self</span><span class='o'>.</span><span class='n'>slug</span> <span class='o'>=</span> <span class='n'>re</span><span class='o'>.</span><span class='n'>sub</span><span class='p'>(</span><span class='s'>&quot;[ ?]&quot;</span><span class='p'>,</span> <span class='s'>&quot;-&quot;</span><span class='p'>,</span> <span class='bp'>self</span><span class='o'>.</span><span class='n'>title</span><span class='p'>)</span><span class='o'>.</span><span class='n'>lower</span><span class='p'>()</span>
<span class='o'>+</span>			<span class='c'>#original blogofile hack by zzzeek			</span>
<span class='o'>+</span>			<span class='c'>#http://techspot.zzzeek.org/2010/12/06/my-blogofile-hacks/</span>
<span class='o'>+</span>
<span class='o'>+</span>			<span class='n'>slug</span> <span class='o'>=</span> <span class='bp'>self</span><span class='o'>.</span><span class='n'>title</span><span class='o'>.</span><span class='n'>lower</span><span class='p'>()</span>
<span class='o'>+</span>
<span class='o'>+</span>			<span class='c'>#accents replaced by the corresponding letters without accent</span>
<span class='o'>+</span>			<span class='n'>nkfd_form</span> <span class='o'>=</span> <span class='n'>unicodedata</span><span class='o'>.</span><span class='n'>normalize</span><span class='p'>(</span><span class='s'>&#39;NFKD&#39;</span><span class='p'>,</span> <span class='nb'>unicode</span><span class='p'>(</span><span class='n'>slug</span><span class='p'>))</span>
<span class='o'>+</span>			<span class='n'>slug</span> <span class='o'>=</span> <span class='s'>u&quot;&quot;</span><span class='o'>.</span><span class='n'>join</span><span class='p'>([</span><span class='n'>c</span> <span class='k'>for</span> <span class='n'>c</span> <span class='ow'>in</span> <span class='n'>nkfd_form</span> <span class='k'>if</span> <span class='ow'>not</span> <span class='n'>unicodedata</span><span class='o'>.</span><span class='n'>combining</span><span class='p'>(</span><span class='n'>c</span><span class='p'>)])</span>
<span class='o'>+</span>
<span class='o'>+</span>			<span class='c'># convert ellipses to spaces</span>
<span class='o'>+</span>			<span class='n'>slug</span> <span class='o'>=</span> <span class='n'>re</span><span class='o'>.</span><span class='n'>sub</span><span class='p'>(</span><span class='s'>r&#39;\.{2,}&#39;</span><span class='p'>,</span> <span class='s'>&#39; &#39;</span><span class='p'>,</span> <span class='n'>slug</span><span class='p'>)</span>
<span class='o'>+</span>
<span class='o'>+</span>			<span class='c'># flatten everything non alpha or . into a single -</span>
<span class='o'>+</span>			<span class='n'>slug</span> <span class='o'>=</span> <span class='n'>re</span><span class='o'>.</span><span class='n'>sub</span><span class='p'>(</span><span class='s'>r&#39;[^0-9a-zA-Z\.]+&#39;</span><span class='p'>,</span> <span class='s'>&#39;-&#39;</span><span class='p'>,</span> <span class='n'>slug</span><span class='p'>)</span>
<span class='o'>+</span>
<span class='o'>+</span>			<span class='c'># trim off leading/trailing -</span>
<span class='o'>+</span>			<span class='n'>slug</span> <span class='o'>=</span> <span class='n'>re</span><span class='o'>.</span><span class='n'>sub</span><span class='p'>(</span><span class='s'>r&#39;^-+|-+$&#39;</span><span class='p'>,</span> <span class='s'>&#39;&#39;</span><span class='p'>,</span> <span class='n'>slug</span><span class='p'>)</span>
<span class='o'>+</span>			<span class='bp'>self</span><span class='o'>.</span><span class='n'>slug</span> <span class='o'>=</span> <span class='n'>slug</span>
<span class='o'>+</span>
<span class='o'>+</span>			<span class='c'>#######################################################</span>
<span class='o'>+</span>
<span class='o'>+</span>			<span class='c'># original</span>
<span class='o'>+</span>			<span class='c'>#self.slug = re.sub(&quot;[ ?]&quot;, &quot;-&quot;, self.title).lower()</span>
<span class='o'>+</span>
<span class='o'>+</span>			<span class='c'>#######################################################</span>
 
	     <span class='k'>if</span> <span class='ow'>not</span> <span class='bp'>self</span><span class='o'>.</span><span class='n'>date</span><span class='p'>:</span>
	         <span class='bp'>self</span><span class='o'>.</span><span class='n'>date</span> <span class='o'>=</span> <span class='n'>datetime</span><span class='o'>.</span><span class='n'>datetime</span><span class='o'>.</span><span class='n'>now</span><span class='p'>(</span><span class='n'>pytz</span><span class='o'>.</span><span class='n'>timezone</span><span class='p'>(</span><span class='bp'>self</span><span class='o'>.</span><span class='n'>__timezone</span><span class='p'>))</span>
</code></pre>
</div>
	</div>
</div>
<div class="row">
	<hr/>
	<div class="large-12 columns">
		<ul id="social_icon">
			<li id="panel1"><a id="twitter" href="" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=600');return false;"></a></li>
			<li id="panel2"><a id="googleplus" href="" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=600');return false;"></a></li>
			<li id="panel3"><a id="facebook" href="" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=600');return false;"></a></li>
		</ul>
		<a href="#top" class="top" alt="Back to top"></a>
	</div>
</div>
<script>
$(document).ready(function() {
	var pathname = encodeURI(window.location);
	var tweeturl = 'http://twitter.com/share?url=' + pathname + '&text=Supprimer les accents des titres blogofile&via=rolalagile';
	$("#twitter").attr("href", tweeturl);

	var googleplusurl = 'https://plus.google.com/share?url=' + pathname
	$("#googleplus").attr("href", googleplusurl);

	var facebookurl = 'http://www.facebook.com/share.php?u=' + pathname
	$("#facebook").attr("href", facebookurl);
});
</script>
<div class="row">

	<div id="disqus_thread" class="large-12 columns"></div>
</div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'guillaumevincent'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
    	var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    	dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
	Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>








<!-- google analytics -->
<script type="text/javascript">

var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-34916388-1']);
_gaq.push(['_setDomainName', 'guillaumevincent.com']);
_gaq.push(['_trackPageview']);

(function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

</script>

<script src="/js/foundation.min.js"></script>
  <!--
  
  <script src="js/foundation/foundation.js"></script>
  
  <script src="js/foundation/foundation.alerts.js"></script>
  
  <script src="js/foundation/foundation.clearing.js"></script>
  
  <script src="js/foundation/foundation.cookie.js"></script>
  
  <script src="js/foundation/foundation.dropdown.js"></script>
  
  <script src="js/foundation/foundation.forms.js"></script>
  
  <script src="js/foundation/foundation.joyride.js"></script>
  
  <script src="js/foundation/foundation.magellan.js"></script>
  
  <script src="js/foundation/foundation.orbit.js"></script>
  
  <script src="js/foundation/foundation.placeholder.js"></script>
  
  <script src="js/foundation/foundation.reveal.js"></script>
  
  <script src="js/foundation/foundation.section.js"></script>
  
  <script src="js/foundation/foundation.tooltips.js"></script>
  
  <script src="js/foundation/foundation.topbar.js"></script>
  
-->

<script>
$(document).foundation();
</script>
</body>
</html>
